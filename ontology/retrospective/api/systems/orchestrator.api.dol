system orchestrator.api @ 0.1.0 {
  api requires rest.api
  api requires mcp.protocol
  api requires workload.management
  api requires node.management
  api requires cluster.observability
  api requires log.access
}

exegesis {
  The orchestrator.api system composes dual interfaces for human (REST) and AI
  (MCP) interactions. REST API (mod.rs exports) provides HTTP endpoints at :8080
  with Axum framework, Ed25519 authentication, CORS/tracing middleware, and JSON
  responses. MCP server (mcp_server/src) exposes JSON-RPC 2.0 over stdio with 8
  tools (list_workloads, create_workload, get_workload, scale_workload, delete_workload,
  list_nodes, get_node, get_cluster_status) and 4 resource URIs. Both interfaces
  share ApiState with StateStore, ClusterManager, and workload submission channel.

  Key architectural decisions:
  1. Axum for async HTTP with type-safe extractors
  2. Ed25519 signatures for cryptographic authentication (not bearer tokens)
  3. Trait-based abstraction (StateStore, ClusterManager) for testability
  4. Channel-based orchestrator communication (decouples API from scheduling)
  5. WebSocket for log streaming (poll-based until runtime supports native streaming)
  6. MCP protocol for AI agent integration (Claude Code compatibility)
  7. JSON Schema generation via schemars for tool definitions

  Version 0.1.0 represents initial prototype with core functionality. Future
  versions should add: distributed tracing (OpenTelemetry), rate limiting,
  pagination, field selectors, watch resources, admission webhooks.
}
