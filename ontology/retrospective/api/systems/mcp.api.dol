system mcp.api @ 1.0.0 {
  api requires mcp.protocol
  api requires workload.management
  api requires node.management
  api requires cluster.observability
}

exegesis {
  MCP API subsystem implements Model Context Protocol specification 2024-11-05 for
  AI agent orchestration. OrchestratorMcpServer<S, C, Sch> is generic over StateStore,
  ClusterManager, Scheduler traits. serve_stdio() runs read-eval-print loop:
  read line from stdin → parse JsonRpcRequest → handle_request() → write
  JsonRpcResponse to stdout. Error handling: parse errors return PARSE_ERROR (-32700),
  unknown methods return METHOD_NOT_FOUND (-32601), invalid params return
  INVALID_PARAMS (-32602), handler exceptions return INTERNAL_ERROR (-32603).

  Tool execution pattern:
  1. tools/list returns ToolInfo[] with name, description, inputSchema (JSON Schema)
  2. tools/call receives (name, arguments) → deserialize to Input type → call
     handle_<tool_name>() → serialize Output → wrap in ("content": [("type": "text",
     "text": JSON)]) format
  3. Resources follow similar pattern: resources/list → ResourceInfo[], resources/read
     receives <uri> → parse_resource_uri() → match ResourcePath → query state →
     return ("contents": [("uri", "mimeType", "text")])

  Design choice to use stdio transport (not HTTP) enables direct integration with
  Claude Code CLI, avoiding network complexity for local AI agents.
}
